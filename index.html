<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Restauracji z Darmow Wod</title>

    <!-- Doczanie styl贸w Leaflet.js (konieczne dla mapy) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    
    <!-- Doczanie Twoich wasnych styl贸w CSS (musi by w tym samym folderze) -->
    <link rel="stylesheet" href="style.css">

    <!-- Doczanie font贸w Google Fonts dla nowoczesnego, czystego wygldu -->
    <!-- Quicksand dla nag贸wk贸w, Lato dla treci. Upewnij si, 偶e masz poczenie z internetem, aby je zaadowa. -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <h1> Mapa Restauracji z Darmow Wod</h1>
        <p>Bo nie sam kaw czowiek 偶yje! Miejsca w Poznaniu, gdzie HO leje si za darmo !</p>
    </header>

    <main>
        <!-- Kontener, w kt贸rym zostanie zaadowana mapa Leaflet -->
        <div id="map"></div>

        <!-- Sekcja dla U偶ytkownik贸w z formularzem do zgaszania nowych miejsc -->
        <div class="container">
            <div class="suggestion-box">
                <h2>Zaproponuj nowe miejsce!</h2>
                <p class="section-description">Znasz restauracj, kawiarni lub inny punkt, kt贸ry chtnie oferuje darmow wod? Daj nam zna!</p>
                
                <!-- Formularz wysyajcy dane do Formspree.io -->
                <!-- PAMITAJ: Adres URL w 'action' to Tw贸j unikalny endpoint Formspree.io -->
                <form action="https://formspree.io/f/xjkrlreo" method="POST" class="suggestion-form">
                    <label for="restaurant_name">Nazwa Miejsca:</label>
                    <input type="text" id="restaurant_name" name="Nazwa Miejsca" required>

                    <label for="location_details">Adres lub Lokalizacja (jak najdokadniej):</label>
                    <input type="text" id="location_details" name="Adres lub Lokalizacja" placeholder="np. ul. Duga 5, Gdask / Rynek G贸wny, obok fontanny" required>

                    <label for="why_water">Czy miaa/ miae okazj skorzysta?</label>
                    <textarea id="why_water" name="Dlaczego Darmowa Woda" placeholder="Np. , korzystaam/em, widziaem jak kto korzysta, obsuga potwierdzia." required></textarea>

                    <label for="user_email">Tw贸j e-mail (opcjonalnie, do kontaktu):</label>
                    <input type="email" id="user_email" name="_replyto" placeholder="tw贸j.email@example.com">

                    <!-- To pole jest dodawane przez Formspree dla podstawowej ochrony przed spamem, ukryte dla u偶ytkownika -->
                    <input type="text" name="_gotcha" style="display:none" />

                    <button type="submit">Wylij Sugesti</button>
                </form>
                <p class="form-info">Po wysaniu sugestii mo偶esz zosta poproszony o weryfikacj "Nie jestem robotem".</p>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Mapa Restauracji z Darmow Wod. Projekt dla spoecznoci. | <a href="#" target="_blank">Polityka Prywatnoci</a></p>
    </footer>

    <!-- Doczanie biblioteki Leaflet.js (konieczne dla dziaania mapy) -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <!-- Tw贸j wasny kod JavaScript, kt贸ry obsuguje map i markery -->
    <script>
        // 1. Inicjalizacja mapy
        // Ustawienie domylnego widoku mapy na centrum Poznania i odpowiedni poziom powikszenia (zoom 14)
        var map = L.map('map').setView([52.40637, 16.92510], 14); // Wsp贸rzdne Placu Wolnoci w Poznaniu

        // 2. Dodanie kafelk贸w mapowych z OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // 3. Definicja niestandardowego markera (ikony kropli wody)
        // Pamitaj, 偶e plik water_drop_marker.svg musi by w tym samym folderze co index.html
        var waterIcon = L.icon({
            iconUrl: 'water_drop_marker.svg', // cie偶ka do Twojego pliku SVG
            iconSize: [35, 35], // Rozmiar ikony w pikselach (szeroko, wysoko)
            iconAnchor: [17, 35], // Punkt "zakotwiczenia" ikony, odpowiadajcy za jej poo偶enie wzgldem wsp贸rzdnych (np. d贸-rodek)
            popupAnchor: [0, -30] // Punkt "zakotwiczenia" wyskakujcego okienka popup, wzgldem ikony
        });

        // 4. Dane o restauracjach (Tutaj Ty, jako waciciel, dodajesz/edytujesz nowe restauracje po weryfikacji)
        var restaurants = [
            // Restauracje w Poznaniu (przykadowe punkty, ich wsp贸rzdne s przybli偶one)
            { 
                name: 'Zen On', 
                address: 'ul. wity Marcin 26/4',
                lat: 52.40697, 
                lon: 16.92070, 
                description: 'Wege/wegaska restauracja, czsto z darmow wod do posiku.' 
            },
            { 
                name: 'Madara', 
                address: 'ul. Szewska 20',
                lat: 52.40879, 
                lon: 16.92982, 
                description: 'Bliskowschodnia kuchnia, mia obsuga, woda dostpna.' 
            },
            { 
                name: 'Starg', 
                address: 'ul. Mickiewicza 21', // Zmieniony adres na popularn lokalizacj Starg
                lat: 52.40938, 
                lon: 16.90691, 
                description: 'Kawiarnia z kaw speciality i darmow wod.' 
            },
            { 
                name: 'M贸wishmash', 
                address: 'ul. Garbary 49',
                lat: 52.40919, 
                lon: 16.93666, 
                description: 'Pyszne hummusy, zawsze dbaj o nawodnienie klient贸w.' 
            },
            { 
                name: 'Trzecia Kawa', 
                address: 'ul. wity Marcin 42',
                lat: 52.40632, 
                lon: 16.92976, 
                description: 'Przyjemna kawiarnia w centrum, uzupenisz bidon.' 
            },
            { 
                name: 'Mitte', 
                address: 'ul. Kocielna 24',
                lat: 52.41697, 
                lon: 16.90807, 
                description: 'Modne miejsce, zapytaj o wod do stolika.' 
            },
            { 
                name: 'Tonari', 
                address: 'ul. Miel偶yskiego 20',
                lat: 52.40833, 
                lon: 16.92842, 
                description: 'Japoska kuchnia, kulturalna obsuga chtnie polewa wod.' 
            },
            // Dodaj wicej restauracji tutaj po ich weryfikacji.
            // PAMITAJ O PRZECINKU PO KA呕DYM OBIECIE, OPRCZ OSTATNIEGO!
            // { name: 'Nazwa Restauracji', address: 'ul. Przykadowa 1', lat: [szeroko_geograficzna], lon: [dugo_geograficzna], description: 'Opis' },
        ];

        // 5. Iteracja przez tablic restauracji i dodawanie marker贸w na mapie z niestandardow ikon
        restaurants.forEach(function(restaurant) {
            var marker = L.marker([restaurant.lat, restaurant.lon], {icon: waterIcon}).addTo(map);
            // Zmieniony format popupu, aby uwzgldnia adres
            marker.bindPopup(
                "<b>" + restaurant.name + "</b><br>" + 
                "Adres: " + (restaurant.address ? restaurant.address : "Brak adresu") + "<br>" +
                (restaurant.description ? restaurant.description : "Brak szczeg贸owego opisu.")
            );
        });

        // 6. Funkcja do lokalizacji u偶ytkownika (opcjonalne)
        // Jeli u偶ytkownik pozwoli na lokalizacj, mapa przeskoczy do jego pozycji,
        // w przeciwnym razie pozostanie wyrodkowana na Poznaniu.
        function onLocationFound(e) {
            var radius = e.accuracy / 2; // Okrelenie promienia dokadnoci lokalizacji
            L.marker(e.latlng).addTo(map)
                .bindPopup("Jeste w promieniu " + radius + " metr贸w od tego punktu").openPopup();
            L.circle(e.latlng, radius).addTo(map); // Dodanie okrgu pokazujcego obszar dokadnoci
            map.setView(e.latlng, 14); // Ustawienie widoku mapy na znalezion lokalizacj
        }

        function onLocationError(e) {
            // Logowanie bdu do konsoli przegldarki, niewidoczne dla u偶ytkownika
            console.error("Bd lokalizacji: " + e.message + ". Mapa pozostaje wyrodkowana na Poznaniu.");
            // Mo偶esz odkomentowa poni偶sz lini, jeli chcesz, aby u偶ytkownik by powiadamiany o bdzie lokalizacji
            // alert("Nie udao si ustali Twojej lokalizacji. Mapa jest wyrodkowana na Poznaniu.");
        }

        // Podpicie funkcji obsugujcych zdarzenia lokalizacji
        map.on('locationfound', onLocationFound);
        map.on('locationerror', onLocationError);

        // Wywoanie pr贸by lokalizacji u偶ytkownika po zaadowaniu mapy, ale bez zmiany domylnego widoku,
        // chyba 偶e lokalizacja jest naprawd dokadna.
        map.locate({setView: false, maxZoom: 16, enableHighAccuracy: true});

        // 7. Funkcja dla Ciebie (waciciela): po klikniciu na mapie poka偶e wsp贸rzdne
        // Przydatne do atwego pozyskiwania wsp贸rzdnych dla nowych punkt贸w.
        var popup = L.popup();

        function onMapClick(e) {
            popup
                .setLatLng(e.latlng)
                .setContent("Wsp贸rzdne kliknicia:<br>" + 
                            "Lat: " + e.latlng.lat.toFixed(6) + "<br>" + 
                            "Lon: " + e.latlng.lng.toFixed(6) +
                            "<br>Skopiuj i wklej do pliku `index.html`!")
                .openOn(map);
        }
        map.on('click', onMapClick); // Podpicie funkcji do zdarzenia kliknicia na mapie

    </script>

</body>
</html>
