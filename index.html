<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Restauracji z Darmow Wod</title>

    <!-- Doczanie styl贸w Leaflet.js (konieczne dla mapy) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    
    <!-- Doczanie Twoich wasnych styl贸w CSS (musi by w tym samym folderze) -->
    <link rel="stylesheet" href="style.css">

    <!-- Doczanie font贸w Google Fonts dla nowoczesnego, czystego wygldu -->
    <!-- Quicksand dla nag贸wk贸w, Lato dla treci -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <h1> Mapa Restauracji z Darmow Wod</h1>
        <p>Znajd藕 miejsca, gdzie bezpatnie uzupenisz swoj butelk. Wsp贸lnie budujmy wiadom i nawodnion spoeczno!</p>
    </header>

    <main>
        <!-- Kontener, w kt贸rym zostanie zaadowana mapa -->
        <div id="map"></div>

        <!-- Sekcja dla U偶ytkownik贸w (formularz sugestii) -->
        <div class="container">
            <div class="suggestion-box">
                <h2>Zaproponuj nowe miejsce!</h2>
                <p class="section-description">Znasz restauracj, kawiarni lub inny punkt, kt贸ry chtnie oferuje darmow wod? Daj nam zna!</p>
                
                <!-- TUTAJ MUSISZ WSTAWI SWJ ADRES URL Z FORMSPREE.IO -->
                <form action="https://formspree.io/f/xjkrlreo" method="POST" class="suggestion-form">
                    <label for="restaurant_name">Nazwa Miejsca:</label>
                    <input type="text" id="restaurant_name" name="Nazwa Miejsca" required>

                    <label for="location_details">Adres lub Lokalizacja (jak najdokadniej):</label>
                    <input type="text" id="location_details" name="Adres lub Lokalizacja" placeholder="np. ul. Duga 5, Gdask / Rynek G贸wny, obok fontanny" required>

                    <label for="why_water">Dlaczego oferuj darmow wod?</label>
                    <textarea id="why_water" name="Dlaczego Darmowa Woda" placeholder="Np. maj kranik do uzupeniania, widziaem znak, obsuga potwierdzia." required></textarea>

                    <label for="user_email">Tw贸j e-mail (opcjonalnie, do kontaktu):</label>
                    <input type="email" id="user_email" name="_replyto" placeholder="tw贸j.email@example.com">

                    <!-- Pole dla podstawowej ochrony przed spamem Formspree -->
                    <input type="text" name="_gotcha" style="display:none" />

                    <button type="submit">Wylij Sugesti</button>
                </form>
                <p class="form-info">Po wysaniu sugestii mo偶esz zosta poproszony o weryfikacj "Nie jestem robotem".</p>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2023 Mapa Restauracji z Darmow Wod. Projekt dla spoecznoci. | <a href="#" target="_blank">Polityka Prywatnoci</a></p>
    </footer>

    <!-- Doczanie biblioteki Leaflet.js (konieczne dla mapy) -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <!-- Tw贸j wasny kod JavaScript -->
    <script>
        // 1. Inicjalizacja mapy
        // Ustawienie domylnego widoku mapy na centrum Poznania i odpowiedni zoom
        var map = L.map('map').setView([52.40637, 16.92510], 14); // Wsp贸rzdne Placu Wolnoci w Poznaniu, zoom 14

        // 2. Dodanie kafelk贸w mapowych (OpenStreetMap)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // 3. Niestandardowy marker - to jest ikona kropli wody!
        var waterIcon = L.icon({
            iconUrl: 'water_drop_marker.svg', // cie偶ka do Twojego pliku SVG
            iconSize: [35, 35], // Rozmiar ikony (szeroko, wysoko)
            iconAnchor: [17, 35], // Punkt "zakotwiczenia" ikony (dolny rodek kropli)
            popupAnchor: [0, -30] // Punkt "zakotwiczenia" popupu wzgldem ikony
        });

        // 4. Dane o restauracjach (Tutaj Ty, jako waciciel, dodajesz/edytujesz swoje restauracje)
        var restaurants = [
            // Restauracje w Poznaniu
            { 
                name: 'Zen On (Pozna)', 
                lat: 52.4172, 
                lon: 16.9069, 
                description: 'Wege/wegaska restauracja, czsto z darmow wod do posiku.' 
            },
            { 
                name: 'Madara (Pozna)', 
                lat: 52.4137, 
                lon: 16.9026, 
                description: 'Bliskowschodnia kuchnia, mia obsuga, woda dostpna.' 
            },
            { 
                name: 'Starg (Pozna)', 
                lat: 52.4150, 
                lon: 16.9000, 
                description: 'Kawiarnia z kaw speciality i darmow wod.' 
            },
            { 
                name: 'M贸wishmash (Pozna)', 
                lat: 52.4004, 
                lon: 16.9157, 
                description: 'Pyszne hummasy, zawsze dbaj o nawodnienie klient贸w.' 
            },
            { 
                name: 'Trzecia Kawa (Pozna)', 
                lat: 52.4077, 
                lon: 16.9298, 
                description: 'Przyjemna kawiarnia w centrum, uzupenisz bidon.' 
            },
            { 
                name: 'Mitte (Pozna)', 
                lat: 52.4087, 
                lon: 16.9262, 
                description: 'Modne miejsce, zapytaj o wod do stolika.' 
            },
            { 
                name: 'Tonari (Pozna)', 
                lat: 52.4069, 
                lon: 16.9295, 
                description: 'Japoska kuchnia, kulturalna obsuga chtnie polewa wod.' 
            },
            // Tutaj mo偶esz dodawa wicej restauracji po ich weryfikacji.
            // PAMITAJ O PRZECINKU PO KA呕DYM OBIECIE, OPRCZ OSTATNIEGO!
            // { name: 'Nazwa Restauracji', lat: [szeroko_geograficzna], lon: [dugo_geograficzna], description: 'Opis' },
        ];

        // 5. Dodawanie marker贸w dla ka偶dej restauracji z niestandardow ikon
        restaurants.forEach(function(restaurant) {
            var marker = L.marker([restaurant.lat, restaurant.lon], {icon: waterIcon}).addTo(map);
            marker.bindPopup(
                "<b>" + restaurant.name + "</b><br>" + 
                (restaurant.description ? restaurant.description : "Brak szczeg贸owego opisu.")
            );
        });

        // 6. Funkcja do lokalizacji u偶ytkownika (opcjonalne)
        // Ta funkcja nadal dziaa, ale mapa pocztkowo jest ju偶 wyrodkowana na Poznaniu.
        // Jeli u偶ytkownik pozwoli na lokalizacj, mapa przeskoczy do jego pozycji.
        function onLocationFound(e) {
            var radius = e.accuracy / 2;
            L.marker(e.latlng).addTo(map)
                .bindPopup("Jeste w promieniu " + radius + " metr贸w od tego punktu").openPopup();
            L.circle(e.latlng, radius).addTo(map);
            map.setView(e.latlng, 14); // Ustaw widok mapy na Twoj lokalizacj
        }

        function onLocationError(e) {
            console.error("Bd lokalizacji: " + e.message + ". Mapa pozostaje wyrodkowana na Poznaniu.");
            // Mo偶esz doda tutaj alert, jeli chcesz, aby u偶ytkownik by powiadamiany o bdzie lokalizacji.
            // alert("Nie udao si ustali Twojej lokalizacji. Mapa jest wyrodkowana na Poznaniu.");
        }

        map.on('locationfound', onLocationFound);
        map.on('locationerror', onLocationError);

        // Spr贸buj zlokalizowa u偶ytkownika po zaadowaniu mapy, ale bez zmiany domylnego widoku,
        // chyba 偶e lokalizacja jest naprawd dokadna.
        map.locate({setView: false, maxZoom: 16, enableHighAccuracy: true});

        // 7. Funkcja dla Ciebie (waciciela): po klikniciu na mapie poka偶e wsp贸rzdne
        var popup = L.popup();

        function onMapClick(e) {
            popup
                .setLatLng(e.latlng)
                .setContent("Wsp贸rzdne kliknicia:<br>" + 
                            "Lat: " + e.latlng.lat.toFixed(6) + "<br>" + 
                            "Lon: " + e.latlng.lng.toFixed(6) +
                            "<br>Skopiuj i wklej do pliku `index.html`!")
                .openOn(map);
        }
        map.on('click', onMapClick);

    </script>

</body>
</html>
